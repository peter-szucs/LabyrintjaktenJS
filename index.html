<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width-device-width, initial-scale = 1.0">
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
        <img id="logga" src="Logga.png">
        <canvas id="bgCanvas" width="352" height="455"></canvas>
        <canvas id="pcCanvas" width="352" height="455"></canvas>
        <canvas id="wallCanvas" width="352" height="455"></canvas>
        <input type="button" id="upButton" class="button" onmousedown="playerUp=true" onmouseup="playerUp=false" value="Upp">
        <input type="button" id="leftButton" class="button" onmousedown="playerLeft=true" onmouseup="playerLeft=false" value=" V ">
        <input type="button" id="rightButton" class="button" onmousedown="playerRight=true" onmouseup="playerRight=false" value=" H ">
        <input type="button" id="downButton" class="button" onmousedown="playerDown=true" onmouseup="playerDown=false" value="Ner">
        <script>
            //window.onload = function() {
                var wallCanvas = document.getElementById('wallCanvas');
                var pcCanvas = document.getElementById('pcCanvas');
                var bgCanvas = document.getElementById('bgCanvas');
                var ctxWalls = wallCanvas.getContext('2d');
                var ctxPc = pcCanvas.getContext('2d');
                var ctxBg = bgCanvas.getContext('2d');
                var mapArray = [
                    [5, 1, 9,  1, 1, 1,  1, 1, 1, 1, 6],
                    [3, 0, 14, 0, 0,  0, 0, 0, 0, 0, 4],
                    [3, 0, 14, 0, 16, 0, 0, 0, 16,0, 4],
                    [3, 0, 14, 0, 14, 0, 24,13,13,13,12],
                    [3, 0, 15, 0, 14, 0, 14,0, 0, 0, 4],
                    [3, 0, 0,  0, 14, 0, 15,0, 18,13,12],
                    [11,13,13, 13,26, 0, 0, 0, 0, 0, 4],
                    [3, 0, 0,  0, 0,  0, 24,13,23,0, 4],
                    [3, 0, 24, 13,13,13, 26,0, 14,0, 4],
                    [3, 0, 15, 0, 0,  0, 0, 0, 25,13,12],
                    [3, 0, 0,  0, 16, 0, 16,0, 0, 0, 4],
                    [11,13,13, 13,21, 0, 25,13,13,13,12],
                    [3, 0, 0,  0, 14, 0, 0, 0, 0, 0, 0],
                    [3, 0, 16, 0, 14, 0, 18,13,23,0, 4],
                    [3, 0, 14, 0, 15, 0, 0, 0, 14,0, 4],
                    [3, 0, 14, 0, 0,  0, 16,0, 14,0, 4],
                    [3, 0, 25, 13,13, 13,20,13,26,0, 4],
                    [3, 0, 0,  0, 0,  0, 0, 0, 0, 0, 4],
                    [8, 2, 2,  2, 2,  2, 2, 2, 2, 2, 7]
                ];
                var ground = new Image();
                var outside = new Image();
                var wall = new Image();
                var playerChar = new Image();
                ground.src = 'ground.png';
                outside.src = 'outside.png';
                wall.src = 'wallStone.png';
                playerChar.src = 'pcDown.png';

                wall.onload = function() {
                    draw();
                };
                playerChar.onload = function() {
                    ctxPc.drawImage(playerChar, 100, 68, 32, 41);
                }
                function draw() {
                    var posX = 0;
                    var posY = 0;
                    for (var i = 0; i < mapArray.length; i++) {
                        for (var j = 0; j < mapArray[i].length; j++) {
                            if (mapArray[i][j] == 1) {
                                ctxWalls.drawImage(wall, posX, posY, 32, 45);
                            }
                            if (mapArray[i][j] == 0) {
                                ctxBg.drawImage(ground, posX, posY, 32, 32);
                            }
                            if (mapArray[i][j] == 8) {
                                ctxBg.drawImage(outside, posX, posY, 32, 45);
                            }
                            if (mapArray[i][j] == 2) {
                                ctxBg.drawImage(wall, posX, posY-21, 32, 45);
                            }
                            posX += 32;
                        }
                        posX = 0;
                        posY += 24;
                    }
                }
                function drawPlayer(canvasX, canvasY) {
                ctxPc.drawImage(playerChar, canvasX, canvasY)
                }
                const animationLoop = [0, 1, 0, 2];
                let currentLoopIndex = 0;
                let frameCount = 0;
                let currentDirection = 0;

                /*let keyPresses = {};
                window.addEventListener('keydown', keyDownListener, false);
                function keyDownListener(event) {
                    keyPresses[event.key] = true;
                }
                window.addEventListener('keyup', keyUpListener, false);
                function keyUpListener(event) {
                    keyPresses[event.key] = false;
                }
                */
                const moveSpeed = 1;
                let positionX = 32;
                let positionY = 18;
                let playerUp = false;
                let playerDown = false;
                let playerLeft = false;
                let playerRight = false;

                function gameLoop() {
                    ctxPc.clearRect(0, 0, pcCanvas.width, pcCanvas.height);
                    if (playerUp == true) {
                        positionY -= moveSpeed;
                    }
                    else if (playerDown == true) {
                        positionY += moveSpeed;
                    }
                    if (playerLeft == true) {
                        positionX -= moveSpeed;
                    }
                    else if (playerRight == true) {
                        positionX += moveSpeed;
                    }
                    drawPlayer(positionX, positionY);
                    window.requestAnimationFrame(gameLoop);
                    console.log(positionX, positionY);
                }
                gameLoop();
            //}
            


        </script>
    </body>
</html>